import{j as e,b as G,r,a as J,h as K,c as O,L as n}from"./index-kiCIfI36.js";import{c as F,b as V,m as x,B as p}from"./button-DPDK__u2.js";import{C as w}from"./card-DPj_v_4u.js";import{L as h,A as W,a as X}from"./alert-COJ_phtJ.js";import{S as Y}from"./separator-B8f2-tD2.js";import{H as k,F as S,S as Z}from"./Footer-DnH7jOSd.js";import{g as ee}from"./products-DbtuoVDG.js";import{C as m}from"./chevron-right-019fSgxG.js";import{C as te}from"./chevron-left-BPljMCeZ.js";import{S as L}from"./star-B2agzj44.js";import{L as z}from"./loader-circle-B6nL63xQ.js";import{T as se}from"./thumbs-up-CaP-JlRr.js";import{T as ae}from"./trash-2-Dn980YT0.js";import"./Combination-D_3yussR.js";import"./user-Bjm6U890.js";const ce=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],re=F("heart",ce);const ie=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],oe=F("send",ie);function de({className:i,...s}){return e.jsx("textarea",{"code-path":"src\\components\\ui\\textarea.tsx:7:5","data-slot":"textarea",className:V("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),...s})}function ve(){const{id:i}=G(),[s]=r.useState(ee(i||"")||null),[u,g]=r.useState(1),[j,f]=r.useState(5),[o,D]=r.useState(""),[P,N]=r.useState(!1),[B,b]=r.useState(!1),[l,d]=r.useState([]),[A,y]=r.useState(!1),{addItem:E}=J(),{getCommentsByProductId:v,addComment:T,likeComment:_,deleteComment:I}=K(),C=O();r.useEffect(()=>{if(!i||!s){C("/products");return}(async()=>{y(!0);const a=await v(i);d(a),y(!1)})()},[i,s,C,v]);const $=()=>{s&&E({id:s.id,name:s.name,image:s.image,price:s.price,quantity:u})},H=async()=>{if(!(!s||!o.trim())){N(!0);try{const t=await T(s.id,j,o);d(a=>[t,...a]),D(""),f(5),b(!0),setTimeout(()=>b(!1),3e3)}catch(t){console.error("提交评论失败:",t)}finally{N(!1)}}},M=async t=>{await _(t),d(a=>a.map(c=>c.id===t?{...c,likes:c.isLiked?c.likes-1:c.likes+1,isLiked:!c.isLiked}:c))},R=async t=>{await I(t)&&d(c=>c.filter(U=>U.id!==t))},q=t=>new Date(t).toLocaleDateString("zh-CN"),Q=t=>Array(5).fill(0).map((a,c)=>e.jsx(L,{"code-path":"src\\pages\\ProductDetail.tsx:108:7",size:16,className:`${c<t?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},c));return s?e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:134:5",className:"min-h-screen flex flex-col",children:[e.jsx(k,{"code-path":"src\\pages\\ProductDetail.tsx:135:7"}),e.jsxs("main",{"code-path":"src\\pages\\ProductDetail.tsx:137:7",className:"flex-1 bg-gray-50",children:[e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:139:9",className:"bg-white border-b",children:e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:140:11",className:"page-container py-4",children:e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:141:13",className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(n,{"code-path":"src\\pages\\ProductDetail.tsx:142:15",to:"/",className:"hover:text-[#F5B800] transition-colors",children:"首页"}),e.jsx(m,{"code-path":"src\\pages\\ProductDetail.tsx:143:15",size:16}),e.jsx(n,{"code-path":"src\\pages\\ProductDetail.tsx:144:15",to:"/products",className:"hover:text-[#F5B800] transition-colors",children:"产品"}),e.jsx(m,{"code-path":"src\\pages\\ProductDetail.tsx:145:15",size:16}),e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:146:15",className:"text-gray-800 font-medium",children:s.name})]})})}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:152:9",className:"page-container py-12",children:[e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:153:11",className:"grid lg:grid-cols-2 gap-12",children:[e.jsx(x.div,{"code-path":"src\\pages\\ProductDetail.tsx:155:13",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6},children:e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:160:15",className:"relative rounded-2xl overflow-hidden shadow-lg mb-4",children:e.jsx("img",{"code-path":"src\\pages\\ProductDetail.tsx:161:17",src:s.image,alt:s.name,className:"w-full h-[400px] object-cover"})})}),e.jsxs(x.div,{"code-path":"src\\pages\\ProductDetail.tsx:170:13",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.6},children:[e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:175:15",className:"mb-2",children:e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:176:17",className:"px-3 py-1 bg-[#F5B800]/10 text-[#F5B800] text-sm rounded-full",children:s.category})}),e.jsx("h1",{"code-path":"src\\pages\\ProductDetail.tsx:178:15",className:"text-3xl font-bold text-gray-800 mb-2",children:s.name}),e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:179:15",className:"text-gray-500 mb-4",children:s.nameEn}),e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:180:15",className:"flex items-center gap-2 mb-6",children:e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:181:17",className:"text-2xl font-bold text-[#F5B800]",children:["¥",s.price.toFixed(1)]})}),e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:184:15",className:"text-gray-600 mb-8",children:s.description||"暂无详细描述"}),e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:186:15",className:"flex flex-col sm:flex-row gap-4 mb-8",children:e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:187:17",className:"flex items-center gap-2",children:[e.jsx(h,{"code-path":"src\\pages\\ProductDetail.tsx:188:19",htmlFor:"quantity",children:"数量"}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:189:19",className:"flex items-center border rounded-lg overflow-hidden",children:[e.jsx("button",{"code-path":"src\\pages\\ProductDetail.tsx:190:21",onClick:()=>g(t=>Math.max(1,t-1)),className:"w-10 h-10 flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(te,{"code-path":"src\\pages\\ProductDetail.tsx:194:23",size:16})}),e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:196:21",className:"w-12 text-center font-medium",children:u}),e.jsx("button",{"code-path":"src\\pages\\ProductDetail.tsx:197:21",onClick:()=>g(t=>t+1),className:"w-10 h-10 flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(m,{"code-path":"src\\pages\\ProductDetail.tsx:201:23",size:16})})]})]})}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:207:15",className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(p,{"code-path":"src\\pages\\ProductDetail.tsx:208:17",onClick:$,className:"flex-1 bg-[#F5B800] hover:bg-[#E5A800] text-white",children:[e.jsx(Z,{"code-path":"src\\pages\\ProductDetail.tsx:212:19",size:18,className:"mr-2"}),"加入购物车"]}),e.jsxs(p,{"code-path":"src\\pages\\ProductDetail.tsx:215:17",variant:"outline",className:"flex-1",children:[e.jsx(re,{"code-path":"src\\pages\\ProductDetail.tsx:219:19",size:18,className:"mr-2"}),"收藏"]})]})]})]}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:227:11",className:"mt-16",children:[e.jsx(Y,{"code-path":"src\\pages\\ProductDetail.tsx:228:13",className:"mb-8"}),e.jsxs(x.div,{"code-path":"src\\pages\\ProductDetail.tsx:230:13",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs("h2",{"code-path":"src\\pages\\ProductDetail.tsx:235:15",className:"text-2xl font-bold text-gray-800 mb-8",children:["用户评价 (",l.length,")"]}),e.jsxs(w,{"code-path":"src\\pages\\ProductDetail.tsx:238:15",className:"p-6 mb-8",children:[e.jsx("h3",{"code-path":"src\\pages\\ProductDetail.tsx:239:17",className:"text-lg font-semibold mb-4",children:"发表评价"}),B&&e.jsx(W,{"code-path":"src\\pages\\ProductDetail.tsx:242:19",className:"mb-4",children:e.jsx(X,{"code-path":"src\\pages\\ProductDetail.tsx:243:21",children:"评论提交成功！"})}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:247:17",className:"space-y-4",children:[e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:248:19",children:[e.jsx(h,{"code-path":"src\\pages\\ProductDetail.tsx:249:21",className:"block mb-2",children:"评分"}),e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:250:21",className:"flex items-center gap-2",children:Array(5).fill(0).map((t,a)=>e.jsx("button",{"code-path":"src\\pages\\ProductDetail.tsx:252:25",type:"button",onClick:()=>f(a+1),className:"cursor-pointer",children:e.jsx(L,{"code-path":"src\\pages\\ProductDetail.tsx:258:27",size:24,className:`${a<j?"text-yellow-400 fill-yellow-400":"text-gray-300"}`})},a))})]}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:267:19",children:[e.jsx(h,{"code-path":"src\\pages\\ProductDetail.tsx:268:21",htmlFor:"comment",className:"block mb-2",children:"评价内容"}),e.jsx(de,{"code-path":"src\\pages\\ProductDetail.tsx:269:21",id:"comment",value:o,onChange:t=>D(t.target.value),placeholder:"请输入您的评价...",rows:4,className:"resize-none"})]}),e.jsx(p,{"code-path":"src\\pages\\ProductDetail.tsx:279:19",onClick:H,disabled:!o.trim()||P,className:"bg-[#F5B800] hover:bg-[#E5A800] text-white",children:P?e.jsxs(e.Fragment,{children:[e.jsx(z,{"code-path":"src\\pages\\ProductDetail.tsx:286:25",size:18,className:"mr-2 animate-spin"}),"提交中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{"code-path":"src\\pages\\ProductDetail.tsx:291:25",size:18,className:"mr-2"}),"提交评价"]})})]})]}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:300:15",children:[e.jsx("h3",{"code-path":"src\\pages\\ProductDetail.tsx:301:17",className:"text-lg font-semibold mb-4",children:"全部评价"}),A?e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:304:19",className:"text-center py-12",children:[e.jsx(z,{"code-path":"src\\pages\\ProductDetail.tsx:305:21",className:"w-8 h-8 text-[#F5B800] animate-spin mx-auto mb-4"}),e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:306:21",className:"text-gray-500",children:"加载评价中..."})]}):l.length===0?e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:309:19",className:"text-center py-12",children:e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:310:21",className:"text-gray-500",children:"暂无评价，快来发表第一条评价吧！"})}):e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:313:19",className:"space-y-6",children:l.map(t=>e.jsxs(w,{"code-path":"src\\pages\\ProductDetail.tsx:315:23",className:"p-6",children:[e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:316:25",className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:317:27",className:"flex items-center gap-3",children:[e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:318:29",className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:319:31",className:"font-medium text-gray-600",children:t.username.charAt(0)})}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:321:29",children:[e.jsx("h4",{"code-path":"src\\pages\\ProductDetail.tsx:322:31",className:"font-medium",children:t.username}),e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:323:31",className:"flex items-center gap-1 mt-1",children:[Q(t.rating),e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:325:33",className:"text-sm text-gray-500 ml-2",children:q(t.createdAt)})]})]})]}),e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:329:27",children:e.jsxs("button",{"code-path":"src\\pages\\ProductDetail.tsx:330:29",onClick:()=>M(t.id),className:`flex items-center gap-1 text-sm ${t.isLiked?"text-blue-500":"text-gray-500 hover:text-blue-500"}`,children:[e.jsx(se,{"code-path":"src\\pages\\ProductDetail.tsx:336:31",size:16}),e.jsx("span",{"code-path":"src\\pages\\ProductDetail.tsx:337:31",children:t.likes})]})})]}),e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:342:25",className:"text-gray-600 mb-4",children:t.content}),e.jsx("div",{"code-path":"src\\pages\\ProductDetail.tsx:344:25",className:"flex justify-end",children:e.jsxs("button",{"code-path":"src\\pages\\ProductDetail.tsx:345:27",onClick:()=>R(t.id),className:"text-red-500 hover:text-red-600 text-sm flex items-center gap-1",children:[e.jsx(ae,{"code-path":"src\\pages\\ProductDetail.tsx:349:29",size:14}),"删除"]})})]},t.id))})]})]})]})]})]}),e.jsx(S,{"code-path":"src\\pages\\ProductDetail.tsx:363:7"})]}):e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:118:7",className:"min-h-screen flex flex-col",children:[e.jsx(k,{"code-path":"src\\pages\\ProductDetail.tsx:119:9"}),e.jsx("main",{"code-path":"src\\pages\\ProductDetail.tsx:120:9",className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{"code-path":"src\\pages\\ProductDetail.tsx:121:11",className:"text-center",children:[e.jsx("p",{"code-path":"src\\pages\\ProductDetail.tsx:122:13",className:"text-gray-500",children:"产品不存在"}),e.jsx(n,{"code-path":"src\\pages\\ProductDetail.tsx:123:13",to:"/products",className:"mt-4 inline-block px-6 py-2 bg-[#F5B800] text-white rounded-full hover:bg-[#E5A800] transition-colors",children:"返回产品列表"})]})}),e.jsx(S,{"code-path":"src\\pages\\ProductDetail.tsx:128:9"})]})}export{ve as default};
